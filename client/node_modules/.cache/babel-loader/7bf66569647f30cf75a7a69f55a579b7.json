{"ast":null,"code":"/*!\n * TableExport.js v5.2.0 (https://www.travismclarke.com)\n *\n * Copyright (c) 2018 - Travis Clarke - https://www.travismclarke.com\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n(function (root, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    // AMD\n    define(function (require) {\n      var $;\n\n      try {\n        $ = require(\"jquery\");\n      } catch (e) {}\n\n      return factory($, require(\"blobjs\"), require(\"file-saverjs\"), require(\"xlsx\"));\n    });\n  } else if (typeof exports === \"object\" && typeof exports.nodeName !== \"string\") {\n    // CommonJS\n    var $;\n\n    try {\n      $ = require(\"jquery\");\n    } catch (e) {}\n\n    module.exports = factory($, require(\"blobjs\"), require(\"file-saverjs\"), require(\"xlsx\"));\n  } else {\n    // Browser globals\n    root.TableExport = factory(root.jQuery, root.Blob, root.saveAs, root.XLSX);\n  }\n})(this, function ($, Blob, saveAs, XLSX) {\n  \"use strict\";\n  /**\n   * TableExport main library constructor\n   * @param selectors {jQuery} jQuery selector(s)\n   * @param options {Object} TableExport configuration options\n   * @constructor\n   */\n\n  var TableExport = function (selectors, options) {\n    var self = this;\n    if (!selectors) return _handleError('\"selectors\" is required. \\nUsage: TableExport(selectors, options)');\n    if (!self) return new TableExport(selectors, options);\n    /**\n     * TableExport configuration options (user-defined w/ default fallback)\n     */\n\n    self.settings = _extend({}, self.defaults, options);\n    /**\n     * Selectors (tables) to apply the library to\n     */\n\n    self.selectors = _nodesArray(selectors);\n    var settings = self.settings;\n    settings.ignoreRows = settings.ignoreRows instanceof Array ? settings.ignoreRows : [settings.ignoreRows];\n    settings.ignoreCols = settings.ignoreCols instanceof Array ? settings.ignoreCols : [settings.ignoreCols];\n    settings.ignoreCSS = self.ignoreCSS instanceof Array ? self.ignoreCSS : [self.ignoreCSS];\n    settings.emptyCSS = self.emptyCSS instanceof Array ? self.emptyCSS : [self.emptyCSS];\n    settings.formatValue = self.formatValue.bind(this, settings.trimWhitespace);\n    settings.bootstrapSettings = _getBootstrapSettings(settings.bootstrap, self.bootstrapConfig, self.defaultButton);\n    var _exportData = {};\n\n    self.getExportData = function () {\n      return _exportData;\n    };\n\n    self.selectors.forEach(function (el) {\n      var context = {};\n      context.rows = _nodesArray(el.querySelectorAll(\"tbody > tr\"));\n      context.rows = settings.headers ? _nodesArray(el.querySelectorAll(\"thead > tr\")).concat(context.rows) : context.rows;\n      context.rows = settings.footers ? context.rows.concat(_nodesArray(el.querySelectorAll(\"tfoot > tr\"))) : context.rows;\n      context.thAdj = settings.headers ? el.querySelectorAll(\"thead > tr\").length : 0;\n      context.filename = settings.filename === \"id\" ? el.getAttribute(\"id\") || self.defaultFilename : settings.filename || self.defaultFilename;\n      context.sheetname = settings.sheetname === \"id\" ? el.getAttribute(\"id\") || self.defaultSheetname : settings.sheetname || self.defaultSheetname;\n      context.uuid = _uuid(el);\n      /**\n       * Initializes table caption with export buttons\n       * @param exportButton {HTMLButtonElement}\n       */\n\n      context.checkCaption = function (exportButton) {\n        var caption = el.querySelectorAll(\"caption.\" + self.defaultCaptionClass);\n\n        if (caption.length) {\n          caption[0].appendChild(exportButton);\n        } else {\n          caption = document.createElement(\"caption\");\n          caption.className = settings.bootstrapSettings.bootstrapSpacing + self.defaultCaptionClass;\n          caption.style.cssText = \"caption-side: \" + settings.position;\n          caption.appendChild(exportButton);\n          el.insertBefore(caption, el.firstChild);\n        }\n      };\n\n      context.setExportData = function () {\n        return function (exporter) {\n          var data = Storage.getInstance().getItem(exporter);\n          var type = exporter.substring(exporter.indexOf(\"-\") + 1);\n          _exportData[context.uuid] = _exportData[context.uuid] || {};\n          _exportData[context.uuid][type] = JSON.parse(data);\n        };\n      }();\n\n      context.rcMap = new RowColMap().build(context, settings);\n\n      var formatMap = _FORMAT_LIST.reduce(function (acc, cur) {\n        acc[cur] = 0;\n        return acc;\n      }, {});\n\n      settings.formats.forEach(function (key) {\n        if (!_isValidFormat(key)) {\n          return _handleError('\"' + key + '\" is not a valid format. \\nFormats: ' + _FORMAT_LIST.join(\", \"));\n        } else if (!_hasDependencies(key)) {\n          // TODO: provide a fallback option to XLS?\n          return _handleError('\"' + key + '\" requires \"js-xlsx\".');\n        } else if (!formatMap[key]) {\n          context.setExportData(self.exporters.build.call(self, context, key));\n          formatMap[key]++;\n        }\n      });\n    });\n    var exportButton = document.querySelectorAll(\"button[\" + self.storageKey + \"]\");\n\n    _on(exportButton, \"click\", self.downloadHandler, self);\n\n    return self;\n  };\n\n  TableExport.prototype = {\n    /**\n     * Version.\n     * @memberof TableExport.prototype\n     */\n    version: \"5.2.0\",\n\n    /**\n     * Default library options.\n     * @memberof TableExport.prototype\n     */\n    defaults: {\n      headers: true,\n      // (Boolean), display table headers (th or td elements) in the <thead>, (default: true)\n      footers: true,\n      // (Boolean), display table footers (th or td elements) in the <tfoot>, (default: false)\n      formats: [\"xlsx\", \"csv\", \"txt\"],\n      // (String[]), filetype(s) for the export, (default: ['xlsx', 'csv', 'txt'])\n      filename: \"id\",\n      // (id, String), filename for the downloaded file, (default: 'id')\n      bootstrap: false,\n      // (Boolean), style buttons using bootstrap, (default: true)\n      exportButtons: true,\n      // (Boolean), automatically generate the built-in export buttons for each of the specified formats (default: true)\n      position: \"bottom\",\n      // (top, bottom), position of the caption element relative to table, (default: 'bottom')\n      ignoreRows: null,\n      // (Number, Number[]), row indices to exclude from the exported file(s) (default: null)\n      ignoreCols: null,\n      // (Number, Number[]), column indices to exclude from the exported file(s) (default: null)\n      trimWhitespace: true,\n      // (Boolean), remove all leading/trailing newlines, spaces, and tabs from cell text in the exported file(s) (default: false)\n      RTL: false,\n      // (Boolean), set direction of the worksheet to right-to-left (default: false)\n      sheetname: \"id\" // (id, String), sheet name for the exported spreadsheet, (default: 'id')\n\n    },\n\n    /**\n     * Constants\n     * @memberof TableExport.prototype\n     */\n    CONSTANTS: {\n      FORMAT: {\n        XLSX: \"xlsx\",\n        XLSM: \"xlsm\",\n        XLSB: \"xlsb\",\n        BIFF2: \"biff2\",\n        XLS: \"xls\",\n        CSV: \"csv\",\n        TXT: \"txt\"\n      },\n      TYPE: {\n        STRING: \"s\",\n        NUMBER: \"n\",\n        BOOLEAN: \"b\",\n        DATE: \"d\"\n      }\n    },\n\n    /**\n     * Character set (character encoding) of the HTML.\n     * @memberof TableExport.prototype\n     */\n    charset: \"charset=utf-8\",\n\n    /**\n     * Filename fallback for exported files.\n     * @memberof TableExport.prototype\n     */\n    defaultFilename: \"myDownload\",\n\n    /**\n     * Sheetname fallback for exported files.\n     * @memberof TableExport.prototype\n     */\n    defaultSheetname: \"myWorksheet\",\n\n    /**\n     * Class applied to each export button element.\n     * @memberof TableExport.prototype\n     */\n    defaultButton: \"button-default\",\n\n    /**\n     * Class applied to each table caption.\n     * @memberof TableExport.prototype\n     */\n    defaultCaptionClass: \"tableexport-caption\",\n\n    /**\n     * Namespace (i.e. prefix) applied to each table UUID and Storage key.\n     * @memberof TableExport.prototype\n     */\n    defaultNamespace: \"tableexport-\",\n\n    /**\n     * Attribute applied to each table element used to generate each Storage key.\n     * @memberof TableExport.prototype\n     */\n    tableKey: \"tableexport-key\",\n\n    /**\n     * Attribute applied to each export button element used to reference a Storage key.\n     * @memberof TableExport.prototype\n     */\n    storageKey: \"tableexport-id\",\n\n    /**\n     * CSS selector or selector[] to exclude/remove cells from the exported file(s).\n     * @type {selector|selector[]}\n     * @memberof TableExport.prototype\n     */\n    ignoreCSS: \".tableexport-ignore\",\n\n    /**\n     * CSS selector or selector[] to replace cells with an empty string in the exported file(s).\n     * @type {selector|selector[]}\n     * @memberof TableExport.prototype\n     */\n    emptyCSS: \".tableexport-empty\",\n\n    /**\n     * Bootstrap configuration classes ['base', 'theme', 'container'].\n     * @memberof TableExport.prototype\n     */\n    bootstrapConfig: [\"btn\", \"btn-default\", \"btn-toolbar\"],\n\n    /**\n     * Row delimeter\n     * @memberof TableExport.prototype\n     */\n    rowDel: \"\\r\\n\",\n\n    /**\n     * HTML entity mapping for special characters.\n     * @memberof TableExport.prototype\n     */\n    entityMap: {\n      \"&\": \"&#38;\",\n      \"<\": \"&#60;\",\n      \">\": \"&#62;\",\n      \"'\": \"&#39;\",\n      \"/\": \"&#47;\"\n    },\n\n    /**\n     * Format configuration\n     * @memberof TableExport.prototype\n     */\n    formatConfig: {\n      /**\n       * XLSX (Open XML spreadsheet) file extension configuration\n       * @memberof TableExport.prototype\n       */\n      xlsx: {\n        defaultClass: \"xlsx\",\n        buttonContent: \"Export to xlsx\",\n        mimeType: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n        fileExtension: \".xlsx\"\n      },\n      xlsm: {\n        defaultClass: \"xlsm\",\n        buttonContent: \"Export to xlsm\",\n        mimeType: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n        fileExtension: \".xlsm\"\n      },\n      xlsb: {\n        defaultClass: \"xlsb\",\n        buttonContent: \"Export to xlsb\",\n        mimeType: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\n        fileExtension: \".xlsb\"\n      },\n\n      /**\n       * XLS (Binary spreadsheet) file extension configuration\n       * @memberof TableExport.prototype\n       */\n      xls: {\n        defaultClass: \"xls\",\n        buttonContent: \"Export to xls\",\n        separator: \"\\t\",\n        mimeType: \"application/vnd.ms-excel\",\n        fileExtension: \".xls\",\n        enforceStrictRFC4180: false\n      },\n\n      /**\n       * CSV (Comma Separated Values) file extension configuration\n       * @memberof TableExport.prototype\n       */\n      csv: {\n        defaultClass: \"csv\",\n        buttonContent: \"Export to csv\",\n        separator: \",\",\n        mimeType: \"text/csv\",\n        fileExtension: \".csv\",\n        enforceStrictRFC4180: true\n      },\n\n      /**\n       * TXT (Plain Text) file extension configuration\n       * @memberof TableExport.prototype\n       */\n      txt: {\n        defaultClass: \"txt\",\n        buttonContent: \"Export to txt\",\n        separator: \"  \",\n        mimeType: \"text/plain\",\n        fileExtension: \".txt\",\n        enforceStrictRFC4180: true\n      }\n    },\n\n    /**\n     * Cell-types override and assertion configuration\n     * @memberof TableExport.prototype\n     */\n    typeConfig: {\n      string: {\n        defaultClass: \"tableexport-string\"\n      },\n      number: {\n        defaultClass: \"tableexport-number\",\n        assert: function (v) {\n          return !isNaN(v);\n        }\n      },\n      boolean: {\n        defaultClass: \"tableexport-boolean\",\n        assert: function (v) {\n          return v.toLowerCase() === \"true\" || v.toLowerCase() === \"false\";\n        }\n      },\n      date: {\n        defaultClass: \"tableexport-date\",\n        assert: function (v) {\n          return !/.*%/.test(v) && !isNaN(Date.parse(v));\n        }\n      }\n    },\n    exporters: {\n      build: function (context, key) {\n        var self = this;\n        var settings = self.settings;\n        var format = self.formatConfig[key];\n        var colDel = format.separator;\n        var rcMap = context.rcMap;\n\n        var getReturn = function (val) {\n          if (_isEnhanced(key)) {\n            return {\n              v: settings.formatValue(val.textContent),\n              t: self.getType(val.className)\n            };\n          }\n\n          switch (key) {\n            case _FORMAT.CSV:\n              return '\"' + settings.formatValue(val.textContent.replace(/\"/g, '\"\"')) + '\"';\n\n            default:\n              return settings.formatValue(val.textContent);\n          }\n        };\n\n        var dataURI = _nodesArray(context.rows).map(function (val, ir) {\n          if (rcMap.isIgnore(ir)) {\n            return rcMap.handleRowColMapProp(rcMap.TYPE.IGNORE);\n          } else if (rcMap.isEmpty(ir)) {\n            return rcMap.handleRowColMapProp(rcMap.TYPE.EMPTY);\n          }\n\n          var cols = val.querySelectorAll(\"th, td\");\n          return _nodesArray(cols).map(function (val, ic) {\n            var _return = getReturn(val);\n\n            if (rcMap.isIgnore(ir, ic)) {\n              return rcMap.handleRowColMapProp(rcMap.TYPE.IGNORE);\n            } else if (rcMap.isEmpty(ir, ic)) {\n              return rcMap.handleRowColMapProp(rcMap.TYPE.EMPTY);\n            } else {\n              return rcMap.handleRowColMapProp(rcMap.TYPE.DEFAULT, ir, ic, key, _return, colDel);\n            }\n          }).processCols(key, colDel);\n        }).processRows(key, self.rowDel);\n\n        var dataObject = JSON.stringify({\n          data: dataURI,\n          filename: context.filename,\n          mimeType: format.mimeType,\n          fileExtension: format.fileExtension,\n          merges: rcMap.merges,\n          RTL: settings.RTL,\n          sheetname: settings.sheetname\n        });\n\n        var hashKey = _hashCode({\n          uuid: context.uuid,\n          type: key\n        });\n\n        settings.exportButtons && context.checkCaption(self.createObjButton(hashKey, dataObject, format.buttonContent, format.defaultClass, settings.bootstrapSettings));\n        return Storage.getInstance().setItem(hashKey, dataObject, true);\n      }\n    },\n\n    /**\n     * Creates file export buttons\n     * @param hashKey {String}\n     * @param dataObject {String}\n     * @param myContent {String}\n     * @param myClass {String}\n     * @param bootstrapSettings {Object}\n     * @returns Element\n     */\n    createObjButton: function (hashKey, dataObject, myContent, myClass, bootstrapSettings) {\n      var exportButton = document.createElement(\"button\");\n      exportButton.setAttribute(\"type\", \"button\");\n      exportButton.setAttribute(this.storageKey, hashKey);\n      exportButton.className = bootstrapSettings.bootstrapClass + bootstrapSettings.bootstrapTheme + myClass;\n      exportButton.textContent = myContent;\n      return exportButton;\n    },\n\n    /**\n     * Escapes special characters with HTML entities\n     * @memberof TableExport.prototype\n     * @param string {String}\n     * @returns {String} escaped string\n     */\n    escapeHtml: function (string) {\n      var self = this;\n      return String(string).replace(/[&<>'\\/]/g, function (s) {\n        return self.entityMap[s];\n      });\n    },\n\n    /**\n     * Unescapes HTML entities to special characters\n     * @memberof TableExport.prototype\n     * @param string {String}\n     * @returns {String} unescaped string\n     */\n    unescapeHtml: function (string) {\n      var str = String(string);\n\n      for (var key in this.entityMap) {\n        str = str.replace(RegExp(this.entityMap[key], \"g\"), key);\n      }\n\n      return str;\n    },\n\n    /**\n     * Removes leading/trailing whitespace from cell string\n     * @param isTrimWhitespace {Boolean}\n     * @param string {String}\n     * @returns {String} trimmed string\n     */\n    formatValue: function (isTrimWhitespace, string) {\n      return isTrimWhitespace ? string.trim() : string;\n    },\n\n    /**\n     * Get cell data-type\n     * @param string {String}\n     * @returns {String} data-type\n     */\n    getType: function (string) {\n      if (!string) return \"\";\n      var types = this.typeConfig;\n\n      if (~string.indexOf(types.string.defaultClass)) {\n        return _TYPE.STRING;\n      } else if (~string.indexOf(types.number.defaultClass)) {\n        return _TYPE.NUMBER;\n      } else if (~string.indexOf(types.boolean.defaultClass)) {\n        return _TYPE.BOOLEAN;\n      } else if (~string.indexOf(types.date.defaultClass)) {\n        return _TYPE.DATE;\n      } else {\n        return \"\";\n      }\n    },\n\n    /**\n     * Formats datetimes for compatibility with Excel\n     * @memberof TableExport.prototype\n     * @param v {Number}\n     * @param date1904 {Date}\n     * @returns {Number} epoch time\n     */\n    dateNum: function (v, date1904) {\n      if (date1904) v += 1462;\n      var epoch = Date.parse(v);\n      var result = (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n      return Math.floor(result);\n    },\n\n    /**\n     * Creates an Excel spreadsheet from a data string\n     * @memberof TableExport.prototype\n     * @param data {String}\n     * @param merges {Object[]}\n     */\n    createSheet: function (data, merges) {\n      var ws = {};\n      var range = {\n        s: {\n          c: 10000000,\n          r: 10000000\n        },\n        e: {\n          c: 0,\n          r: 0\n        }\n      };\n      var types = this.typeConfig;\n\n      for (var R = 0; R !== data.length; ++R) {\n        for (var C = 0; C !== data[R].length; ++C) {\n          if (range.s.r > R) range.s.r = R;\n          if (range.s.c > C) range.s.c = C;\n          if (range.e.r < R) range.e.r = R;\n          if (range.e.c < C) range.e.c = C;\n          var cell = data[R][C];\n          if (!cell || !cell.v) continue;\n          var cell_ref = XLSX.utils.encode_cell({\n            c: C,\n            r: R\n          });\n\n          if (!cell.t) {\n            if (types.number.assert(cell.v)) cell.t = _TYPE.NUMBER;else if (types.boolean.assert(cell.v)) cell.t = _TYPE.BOOLEAN;else if (types.date.assert(cell.v)) cell.t = _TYPE.DATE;else cell.t = _TYPE.STRING;\n          }\n\n          if (cell.t === _TYPE.DATE) {\n            cell.t = _TYPE.NUMBER;\n            cell.z = XLSX.SSF._table[14];\n            cell.v = this.dateNum(cell.v);\n          }\n\n          ws[cell_ref] = cell;\n        }\n      }\n\n      ws[\"!merges\"] = merges;\n      if (range.s.c < 10000000) ws[\"!ref\"] = XLSX.utils.encode_range(range);\n      return ws;\n    },\n\n    /**\n     * Click handler for export button \"download\"\n     * @memberof TableExport.prototype\n     */\n    downloadHandler: function (event) {\n      var target = event.target;\n      var object = JSON.parse(Storage.getInstance().getItem(target.getAttribute(this.storageKey))),\n          data = object.data,\n          filename = object.filename,\n          mimeType = object.mimeType,\n          fileExtension = object.fileExtension,\n          merges = object.merges,\n          RTL = object.RTL,\n          sheetname = object.sheetname;\n      this.export2file(data, mimeType, filename, fileExtension, merges, RTL, sheetname);\n    },\n\n    /**\n     * Excel Workbook constructor\n     * @memberof TableExport.prototype\n     * @constructor\n     */\n    Workbook: function () {\n      this.Workbook = {\n        Views: []\n      };\n      this.SheetNames = [];\n      this.Sheets = {};\n    },\n\n    /**\n     * Converts a string to an arraybuffer\n     * @param s {String}\n     * @memberof TableExport.prototype\n     * @returns {ArrayBuffer}\n     */\n    string2ArrayBuffer: function (s) {\n      var buf = new ArrayBuffer(s.length);\n      var view = new Uint8Array(buf);\n\n      for (var i = 0; i !== s.length; ++i) view[i] = s.charCodeAt(i) & 0xff;\n\n      return buf;\n    },\n\n    /**\n     * Exports and downloads the file\n     * @memberof TableExport.prototype\n     * @param data {String}\n     * @param mime {String} mime type\n     * @param name {String} filename\n     * @param extension {String} file extension\n     * @param merges {Object[]}\n     * @param RTL {Boolean}\n     */\n    export2file: function (data, mime, name, extension, merges, RTL, sheetname) {\n      var format = extension.slice(1);\n      data = this.getRawData(data, extension, name, merges, RTL, sheetname);\n\n      if (_isMobile && (format === _FORMAT.CSV || format === _FORMAT.TXT)) {\n        var dataURI = \"data:\" + mime + \";\" + this.charset + \",\" + data;\n        this.downloadDataURI(dataURI, name, extension);\n      } else {\n        // TODO: error and fallback when `saveAs` not available\n        saveAs(new Blob([data], {\n          type: mime + \";\" + this.charset\n        }), name + extension, true);\n      }\n    },\n    downloadDataURI: function (dataURI, name, extension) {\n      var encodedUri = encodeURI(dataURI);\n      var link = document.createElement(\"a\");\n      link.setAttribute(\"href\", encodedUri);\n      link.setAttribute(\"download\", name + extension);\n      document.body.appendChild(link);\n      link.click();\n    },\n    getBookType: function (key) {\n      switch (key) {\n        case _FORMAT.XLS:\n          return _FORMAT.BIFF2;\n\n        default:\n          return key;\n      }\n    },\n    getRawData: function (data, extension, name, merges, RTL, sheetname) {\n      var key = extension.substring(1);\n\n      if (_isEnhanced(key)) {\n        var wb = new this.Workbook(),\n            ws = this.createSheet(data, merges),\n            bookType = this.getBookType(key);\n        sheetname = sheetname || \"\";\n        wb.SheetNames.push(sheetname);\n        wb.Sheets[sheetname] = ws;\n        wb.Workbook.Views[0] = {\n          RTL: RTL\n        };\n        var wopts = {\n          bookType: bookType,\n          bookSST: false,\n          type: \"binary\"\n        },\n            wbout = XLSX.write(wb, wopts);\n        data = this.string2ArrayBuffer(wbout);\n      }\n\n      return data;\n    },\n    getFileSize: function (data, extension) {\n      var binary = this.getRawData(data, extension);\n      return binary instanceof ArrayBuffer ? binary.byteLength : this.string2ArrayBuffer(binary).byteLength;\n    },\n\n    /**\n     * Updates the library instance with new/updated options\n     * @param options {Object} TableExport configuration options\n     * @returns {TableExport} updated TableExport instance\n     */\n    update: function (options) {\n      this.remove();\n      return new TableExport(this.selectors, _extend({}, this.defaults, options));\n    },\n\n    /**\n     * Reset the library instance to its original state\n     * @returns {TableExport} original TableExport instance\n     */\n    reset: function () {\n      this.remove();\n      return new TableExport(this.selectors, this.settings);\n    },\n\n    /**\n     * Remove the instance (i.e. caption containing the export buttons)\n     */\n    remove: function () {\n      var self = this;\n      this.selectors.forEach(function (el) {\n        var caption = el.querySelector(\"caption.\" + self.defaultCaptionClass);\n        caption && el.removeChild(caption);\n      });\n    }\n  };\n  /**\n   * Storage main interface constructor\n   * @memberof TableExport.prototype\n   * @constructor\n   */\n\n  var Storage = function () {\n    this._instance = null;\n    this.store = sessionStorage;\n    this.namespace = TableExport.prototype.defaultNamespace;\n\n    this.getKey = function (key) {\n      return this.namespace + key;\n    };\n\n    this.setItem = function (_key, value, overwrite) {\n      var key = this.getKey(_key);\n\n      if (this.exists(_key) && !overwrite) {\n        return;\n      }\n\n      if (typeof value !== \"string\") return _handleError('\"value\" must be a string.');\n      this.store.setItem(key, value);\n      return _key;\n    };\n\n    this.getItem = function (_key) {\n      var key = this.getKey(_key);\n      return this.store.getItem(key);\n    };\n\n    this.exists = function (_key) {\n      var key = this.getKey(_key);\n      return this.store.getItem(key) !== null;\n    };\n\n    this.removeItem = function (_key) {\n      var key = this.getKey(_key);\n      return this.store.removeItem(key);\n    };\n  };\n\n  Storage.getInstance = function () {\n    if (!this._instance) {\n      this._instance = new Storage();\n    }\n\n    return this._instance;\n  };\n  /**\n   * RowColMap main interface constructor\n   * @memberof TableExport.prototype\n   * @constructor\n   */\n\n\n  var RowColMap = function () {\n    this.rcMap = [];\n    this.merges = [];\n\n    this.isIgnore = function (ir, ic) {\n      var _ignore = RowColMap.prototype.TYPE.IGNORE;\n      return this.getRowColMapProp(ir, ic, _ignore);\n    };\n\n    this.isEmpty = function (ir, ic) {\n      var _empty = RowColMap.prototype.TYPE.EMPTY;\n      return this.getRowColMapProp(ir, ic, _empty);\n    };\n\n    this.isRowSpan = function (ir) {\n      var _rowspan = RowColMap.prototype.TYPE.ROWSPAN;\n      return this.getRowColMapProp(ir, undefined, _rowspan);\n    };\n\n    this.isColSpan = function (ir) {\n      var _colspan = RowColMap.prototype.TYPE.COLSPAN;\n      return this.getRowColMapProp(ir, undefined, _colspan);\n    };\n\n    this.isSpan = function (ir) {\n      return this.isRowSpan(ir) || this.isColSpan(ir);\n    };\n\n    this.isMerge = function (ir) {\n      return this.merges.length > 0;\n    };\n\n    this.addMerge = function (ir, mergeObj) {\n      var _merge = RowColMap.prototype.TYPE.MERGE;\n      this.merges.push(mergeObj);\n      this.setRowColMapProp(ir, undefined, _merge, this.merges);\n    };\n\n    this.getRowColMapProp = function (ir, ic, key) {\n      if (this.rcMap[ir]) {\n        if (typeof key === \"undefined\") {\n          return this.rcMap[ir][ic];\n        } else if (typeof ic === \"undefined\") {\n          return this.rcMap[ir][key];\n        } else if (this.rcMap[ir][ic]) {\n          return this.rcMap[ir][ic][key];\n        }\n      }\n\n      return undefined;\n    };\n\n    this.setRowColMapProp = function (ir, ic, key, value) {\n      this.rcMap[ir] = this.rcMap[ir] || [];\n\n      if (typeof key === \"undefined\") {\n        return this.rcMap[ir][ic] = value;\n      } else if (typeof ic === \"undefined\") {\n        return this.rcMap[ir][key] = value;\n      } else {\n        this.rcMap[ir][ic] = this.rcMap[ir][ic] || [];\n        return this.rcMap[ir][ic][key] = value;\n      }\n    };\n\n    this.generateTotal = function (ir, ic) {\n      var VALUE = RowColMap.prototype.TYPE.VALUE;\n      var _total = 0;\n\n      if (this.isRowSpan(ir) && this.isColSpan(ir)) {\n        _total = this.getRowColMapProp(ir, ic, VALUE) || 0;\n      } else if (this.getRowColMapProp(ir, ic, VALUE)) {\n        _total = this.getRowColMapProp(ir, ic, VALUE);\n      }\n\n      return _total;\n    };\n\n    this.convertSpanToArray = function (ir, ic, key, _return, colDel) {\n      if (this.rcMap[ir] && this.isSpan(ir)) {\n        var total = this.generateTotal(ir, ic);\n\n        if (_isEnhanced(key)) {\n          return new Array(total).concat(_return);\n        } else {\n          return new Array(total).concat(_return).join(colDel);\n        }\n      }\n\n      return _return;\n    };\n\n    this.handleRowColMapProp = function (type, ir, ic, key, _return, colDel) {\n      switch (type) {\n        case RowColMap.prototype.TYPE.IGNORE:\n          return;\n\n        case RowColMap.prototype.TYPE.EMPTY:\n          return \" \";\n\n        case RowColMap.prototype.TYPE.DEFAULT:\n        default:\n          return this.convertSpanToArray(ir, ic, key, _return, colDel);\n      }\n    };\n  };\n\n  RowColMap.prototype = {\n    OFFSET: 1,\n    TYPE: {\n      IGNORE: \"ignore\",\n      EMPTY: \"empty\",\n      MERGE: \"merge\",\n      ROWSPAN: \"rowspan\",\n      ROWSPANTOTAL: \"rowspantotal\",\n      COLSPAN: \"colspan\",\n      COLSPANTOTAL: \"colspantotal\",\n      DEFAULT: \"default\",\n      VALUE: \"value\"\n    },\n    build: function (context, settings) {\n      var self = this;\n      var OFFSET = self.OFFSET;\n      var rowLength = self.rowLength = context.rows.length; // var colLength = self.colLength = Math.max.apply(null,\n      //     _nodesArray(context.rows).map(function (val) {\n      //         return val.querySelectorAll('th, td').length\n      //     }));\n\n      var handleIgnore = function (ir, ic) {\n        self.setRowColMapProp(ir, ic, self.TYPE.IGNORE, true);\n      };\n\n      var handleEmpty = function (ir, ic) {\n        self.setRowColMapProp(ir, ic, self.TYPE.EMPTY, true);\n      };\n\n      var handleRowSpan = function (val, ir, ic) {\n        var rowSpan = +val.getAttribute(\"rowspan\");\n        var colSpan = +val.getAttribute(\"colspan\");\n        var handledByColSpan, countRowSpan, countColSpan, totalRowSpan, totalColSpan, irStart, irEnd, icStart, icEnd;\n\n        for (var _row = 0; _row < rowSpan; _row++) {\n          if (_row + ir >= rowLength) {\n            return;\n          }\n\n          colSpan && (handledByColSpan = handleColSpan(val, _row + ir, ic, _row > 0, rowSpan));\n\n          if (rowSpan <= 1) {\n            return false;\n          }\n\n          var cur = self.rcMap[\"c\" + (ic - 1)] ? self.rcMap[\"c\" + (ic - 1)][_row + ir] : 0;\n\n          if (cur) {\n            self.rcMap[\"c\" + ic] = self.rcMap[\"c\" + ic] || [];\n            self.rcMap[\"c\" + ic][_row + ir] = (self.rcMap[\"c\" + ic][_row + ir] || 0) + cur;\n          }\n\n          if (rowSpan && _row === 0 && colSpan > 1) {\n            for (var i = 0; i < rowSpan; i++) {\n              self.rcMap[\"c\" + (ic + 1)] = self.rcMap[\"c\" + (ic + 1)] || [];\n              self.rcMap[\"c\" + (ic + 1)][_row + ir + i] = (self.rcMap[\"c\" + (ic + 1)][_row + ir + i] || 0) + Math.max(1, colSpan);\n            }\n          }\n\n          if (_row >= 1) {\n            countRowSpan = self.getRowColMapProp(_row + ir, undefined, self.TYPE.ROWSPAN) || 0;\n            self.setRowColMapProp(_row + ir, undefined, self.TYPE.ROWSPAN, countRowSpan + 1);\n\n            if (!handledByColSpan) {\n              totalRowSpan = self.getRowColMapProp(_row + ir, ic - countRowSpan, self.TYPE.VALUE) || 0;\n              self.setRowColMapProp(_row + ir, ic - countRowSpan, self.TYPE.VALUE, totalRowSpan + 1);\n\n              if (rowSpan > 1 && _row === 1) {\n                var _re = self.rcMap[\"c\" + ic] && self.rcMap[\"c\" + ic][_row + ir];\n\n                totalColSpan = self.getRowColMapProp(ir, undefined, self.TYPE.COLSPANTOTAL) || 0;\n                countColSpan = self.getRowColMapProp(ir, undefined, self.TYPE.COLSPAN) || 0;\n                irStart = ir;\n                irEnd = ir + rowSpan - 1;\n                icStart = ic + totalColSpan - countColSpan + (_re || 0);\n                icEnd = icStart + Math.max(1, colSpan) - 1;\n                handleMerge(irStart, icStart, irEnd, icEnd);\n              }\n            }\n          }\n        }\n      };\n\n      var handleColSpan = function (val, ir, ic, isRowSpan, rowSpan) {\n        var irStart, irEnd, icStart, icEnd;\n        var colSpan = +val.getAttribute(\"colspan\");\n        var countColSpan = self.getRowColMapProp(ir, undefined, self.TYPE.COLSPAN) || 0;\n        var totalColSpan = self.getRowColMapProp(ir, undefined, self.TYPE.COLSPANTOTAL) || 0;\n\n        if (colSpan <= 1) {\n          return false;\n        }\n\n        self.setRowColMapProp(ir, undefined, self.TYPE.COLSPAN, countColSpan + 1);\n        self.setRowColMapProp(ir, undefined, self.TYPE.COLSPANTOTAL, totalColSpan + colSpan);\n\n        if (isRowSpan) {\n          self.setRowColMapProp(ir, ic - countColSpan, self.TYPE.VALUE, colSpan);\n          return true;\n        } else {\n          irStart = ir;\n          irEnd = ir + (rowSpan || 1) - OFFSET;\n          icStart = ic + totalColSpan - countColSpan;\n          icEnd = ic + totalColSpan - countColSpan + (colSpan - OFFSET);\n          self.setRowColMapProp(ir, ic + OFFSET, self.TYPE.VALUE, colSpan - OFFSET);\n          handleMerge(irStart, icStart, irEnd, icEnd);\n        }\n      };\n\n      var handleMerge = function (irs, ics, ire, ice) {\n        var merge = {\n          s: {\n            r: irs,\n            c: ics\n          },\n          e: {\n            r: ire,\n            c: ice\n          }\n        };\n        return self.addMerge(irs, merge);\n      };\n\n      _nodesArray(context.rows).map(function (val, ir) {\n        if (!!~settings.ignoreRows.indexOf(ir - context.thAdj) || _matches(val, settings.ignoreCSS)) {\n          handleIgnore(ir);\n        }\n\n        if (_matches(val, settings.emptyCSS)) {\n          handleEmpty(ir);\n        }\n\n        var cols = val.querySelectorAll(\"th, td\");\n        return _nodesArray(cols).map(function (val, ic) {\n          if (!!~settings.ignoreCols.indexOf(ic) || _matches(val, settings.ignoreCSS)) {\n            handleIgnore(ir, ic);\n          }\n\n          if (_matches(val, settings.emptyCSS)) {\n            handleEmpty(ir, ic);\n          }\n\n          if (val.hasAttribute(\"rowspan\")) {\n            handleRowSpan(val, ir, ic);\n          } else if (val.hasAttribute(\"colspan\")) {\n            handleColSpan(val, ir, ic);\n          }\n        });\n      });\n\n      return self;\n    }\n  };\n\n  var _isMobile = function isMobile(ua) {\n    return /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(ua) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(ua.substring(0, 4));\n  }(navigator.userAgent || navigator.vendor || window.opera);\n\n  var _isEnhanced = function () {\n    return function (key) {\n      return XLSX && !TableExport.prototype.formatConfig[key].enforceStrictRFC4180;\n    };\n  }();\n\n  var _FORMAT = function () {\n    return TableExport.prototype.CONSTANTS.FORMAT;\n  }();\n\n  var _FORMAT_LIST = function () {\n    return Object.keys(_FORMAT).map(function (key) {\n      return _FORMAT[key];\n    });\n  }();\n\n  var _TYPE = function () {\n    return TableExport.prototype.CONSTANTS.TYPE;\n  }();\n\n  Object.defineProperty(Array.prototype, \"processRows\", {\n    enumerable: false,\n    value: function (key, rowDel) {\n      if (_isEnhanced(key)) {\n        return this.map(_toArray).filter(_defined);\n      } else {\n        return this.filter(_defined).join(rowDel);\n      }\n    }\n  });\n  Object.defineProperty(Array.prototype, \"processCols\", {\n    enumerable: false,\n    value: function (key, colDel) {\n      if (_isEnhanced(key)) {\n        return this.filter(_defined);\n      } else {\n        return this.filter(_defined).join(colDel);\n      }\n    }\n  });\n\n  var _uuid = function () {\n    var uuid = 0;\n    return function (el) {\n      var tableKey = el.getAttribute(TableExport.prototype.tableKey);\n\n      if (!tableKey) {\n        tableKey = el.id ? el.id : TableExport.prototype.defaultNamespace + ++uuid;\n        el.setAttribute(TableExport.prototype.tableKey, tableKey);\n      }\n\n      return tableKey;\n    };\n  }();\n\n  var _hashCode = function () {\n    return function (hashKey) {\n      var hash = 0,\n          i,\n          char;\n      var type = hashKey.type;\n      hashKey = JSON.stringify(hashKey);\n      if (hashKey.length === 0) return hash;\n\n      for (i = 0; i < hashKey.length; i++) {\n        char = hashKey.charCodeAt(i);\n        hash = (hash << 5) - hash + char;\n        hash |= 0;\n      }\n\n      return hash.toString(16).substring(1) + \"-\" + type;\n    };\n  }();\n\n  var _on = function () {\n    var prevFn = null;\n    return function (el, event, fn, context) {\n      // , args\n      var curFn = fn.bind(context); // var curFn = fn.bind.apply(fn, [context].concat(args)); // OR [].slice.call(arguments[4]))\n\n      for (var i = 0; i < el.length; ++i) {\n        prevFn && el[i].removeEventListener(event, prevFn, false);\n        el[i].addEventListener(event, curFn, false);\n      }\n\n      prevFn = curFn;\n    };\n  }();\n\n  function _extend() {\n    var args = arguments;\n\n    for (var i = 1; i < args.length; i++) for (var key in args[i]) if (args[i].hasOwnProperty(key)) args[0][key] = args[i][key];\n\n    return args[0];\n  }\n\n  function _nodesArray(els) {\n    return typeof els.length === \"undefined\" ? [].concat(els) : [].slice.call(els);\n  }\n\n  function _hasClass(el, cls) {\n    return el.classList ? el.classList.contains(cls) : new RegExp(\"(^| )\" + cls + \"( |$)\", \"gi\").test(el.cls);\n  }\n\n  function _matches(el, selectors) {\n    return selectors.filter(function (selector) {\n      return [].indexOf.call(document.querySelectorAll(selector), el) !== -1;\n    }).length > 0;\n  }\n\n  function _numeric(val) {\n    return !isNaN(val);\n  }\n\n  function _defined(val) {\n    return typeof val !== \"undefined\";\n  }\n\n  function _toArray(val) {\n    return val instanceof Array ? [].concat.apply([], val) : val;\n  }\n\n  function _isValidFormat(key) {\n    return ~_FORMAT_LIST.indexOf(key);\n  }\n\n  function _hasDependencies(key) {\n    var hasDependencies;\n\n    switch (key) {\n      case _FORMAT.TXT:\n      case _FORMAT.CSV:\n      case _FORMAT.XLS:\n        hasDependencies = true;\n        break;\n\n      default:\n        hasDependencies = _isEnhanced(key);\n    }\n\n    return hasDependencies;\n  }\n\n  function _handleError(msg) {\n    console.error(msg);\n    return new Error(msg);\n  }\n\n  function _getBootstrapSettings(bootstrap, bootstrapConfig, defaultButton) {\n    var config = {};\n\n    if (bootstrap) {\n      config.bootstrapClass = bootstrapConfig[0] + \" \";\n      config.bootstrapTheme = bootstrapConfig[1] + \" \";\n      config.bootstrapSpacing = bootstrapConfig[2] + \" \";\n    } else {\n      config.bootstrapClass = defaultButton + \" \";\n      config.bootstrapTheme = \"\";\n      config.bootstrapSpacing = \"\";\n    }\n\n    return config;\n  }\n\n  if ($) {\n    /**\n     * jQuery TableExport wrapper\n     * @param options {Object} TableExport configuration options\n     * @returns {TableExport} TableExport instance\n     */\n    $.fn.tableExport = function (options) {\n      return TableExport.call(_extend({}, TableExport.prototype, $.fn.tableExport), this, options);\n    }; // alias the TableExport prototype\n\n\n    for (var prop in TableExport.prototype) {\n      $.fn.tableExport[prop] = TableExport.prototype[prop];\n    }\n  }\n\n  TableExport.TableExport = TableExport;\n  return TableExport;\n});","map":{"version":3,"sources":["C:/Users/Sofi/Desktop/Blockinar/blockinar/node_modules/tableexport/dist/js/tableexport.js"],"names":["root","factory","define","amd","require","$","e","exports","nodeName","module","TableExport","jQuery","Blob","saveAs","XLSX","selectors","options","self","_handleError","settings","_extend","defaults","_nodesArray","ignoreRows","Array","ignoreCols","ignoreCSS","emptyCSS","formatValue","bind","trimWhitespace","bootstrapSettings","_getBootstrapSettings","bootstrap","bootstrapConfig","defaultButton","_exportData","getExportData","forEach","el","context","rows","querySelectorAll","headers","concat","footers","thAdj","length","filename","getAttribute","defaultFilename","sheetname","defaultSheetname","uuid","_uuid","checkCaption","exportButton","caption","defaultCaptionClass","appendChild","document","createElement","className","bootstrapSpacing","style","cssText","position","insertBefore","firstChild","setExportData","exporter","data","Storage","getInstance","getItem","type","substring","indexOf","JSON","parse","rcMap","RowColMap","build","formatMap","_FORMAT_LIST","reduce","acc","cur","formats","key","_isValidFormat","join","_hasDependencies","exporters","call","storageKey","_on","downloadHandler","prototype","version","exportButtons","RTL","CONSTANTS","FORMAT","XLSM","XLSB","BIFF2","XLS","CSV","TXT","TYPE","STRING","NUMBER","BOOLEAN","DATE","charset","defaultNamespace","tableKey","rowDel","entityMap","formatConfig","xlsx","defaultClass","buttonContent","mimeType","fileExtension","xlsm","xlsb","xls","separator","enforceStrictRFC4180","csv","txt","typeConfig","string","number","assert","v","isNaN","boolean","toLowerCase","date","test","Date","format","colDel","getReturn","val","_isEnhanced","textContent","t","getType","_FORMAT","replace","dataURI","map","ir","isIgnore","handleRowColMapProp","IGNORE","isEmpty","EMPTY","cols","ic","_return","DEFAULT","processCols","processRows","dataObject","stringify","merges","hashKey","_hashCode","createObjButton","setItem","myContent","myClass","setAttribute","bootstrapClass","bootstrapTheme","escapeHtml","String","s","unescapeHtml","str","RegExp","isTrimWhitespace","trim","types","_TYPE","dateNum","date1904","epoch","result","UTC","Math","floor","createSheet","ws","range","c","r","R","C","cell","cell_ref","utils","encode_cell","z","SSF","_table","encode_range","event","target","object","export2file","Workbook","Views","SheetNames","Sheets","string2ArrayBuffer","buf","ArrayBuffer","view","Uint8Array","i","charCodeAt","mime","name","extension","slice","getRawData","_isMobile","downloadDataURI","encodedUri","encodeURI","link","body","click","getBookType","wb","bookType","push","wopts","bookSST","wbout","write","getFileSize","binary","byteLength","update","remove","reset","querySelector","removeChild","_instance","store","sessionStorage","namespace","getKey","_key","value","overwrite","exists","removeItem","_ignore","getRowColMapProp","_empty","isRowSpan","_rowspan","ROWSPAN","undefined","isColSpan","_colspan","COLSPAN","isSpan","isMerge","addMerge","mergeObj","_merge","MERGE","setRowColMapProp","generateTotal","VALUE","_total","convertSpanToArray","total","OFFSET","ROWSPANTOTAL","COLSPANTOTAL","rowLength","handleIgnore","handleEmpty","handleRowSpan","rowSpan","colSpan","handledByColSpan","countRowSpan","countColSpan","totalRowSpan","totalColSpan","irStart","irEnd","icStart","icEnd","_row","handleColSpan","max","_re","handleMerge","irs","ics","ire","ice","merge","_matches","hasAttribute","isMobile","ua","navigator","userAgent","vendor","window","opera","Object","keys","defineProperty","enumerable","_toArray","filter","_defined","id","hash","char","toString","prevFn","fn","curFn","removeEventListener","addEventListener","args","arguments","hasOwnProperty","els","_hasClass","cls","classList","contains","selector","_numeric","apply","hasDependencies","msg","console","error","Error","config","tableExport","prop"],"mappings":"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","sourcesContent":["/*!\n * TableExport.js v5.2.0 (https://www.travismclarke.com)\n *\n * Copyright (c) 2018 - Travis Clarke - https://www.travismclarke.com\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n(function(root, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    // AMD\n    define(function(require) {\n      var $;\n      try {\n        $ = require(\"jquery\");\n      } catch (e) {}\n      return factory($, require(\"blobjs\"), require(\"file-saverjs\"), require(\"xlsx\"));\n    });\n  } else if (typeof exports === \"object\" && typeof exports.nodeName !== \"string\") {\n    // CommonJS\n    var $;\n    try {\n      $ = require(\"jquery\");\n    } catch (e) {}\n    module.exports = factory($, require(\"blobjs\"), require(\"file-saverjs\"), require(\"xlsx\"));\n  } else {\n    // Browser globals\n    root.TableExport = factory(root.jQuery, root.Blob, root.saveAs, root.XLSX);\n  }\n})(this, function($, Blob, saveAs, XLSX) {\n  \"use strict\";\n  /**\n   * TableExport main library constructor\n   * @param selectors {jQuery} jQuery selector(s)\n   * @param options {Object} TableExport configuration options\n   * @constructor\n   */\n  var TableExport = function(selectors, options) {\n    var self = this;\n\n    if (!selectors) return _handleError('\"selectors\" is required. \\nUsage: TableExport(selectors, options)');\n    if (!self) return new TableExport(selectors, options);\n\n    /**\n     * TableExport configuration options (user-defined w/ default fallback)\n     */\n    self.settings = _extend({}, self.defaults, options);\n    /**\n     * Selectors (tables) to apply the library to\n     */\n    self.selectors = _nodesArray(selectors);\n\n    var settings = self.settings;\n    settings.ignoreRows = settings.ignoreRows instanceof Array ? settings.ignoreRows : [settings.ignoreRows];\n    settings.ignoreCols = settings.ignoreCols instanceof Array ? settings.ignoreCols : [settings.ignoreCols];\n    settings.ignoreCSS = self.ignoreCSS instanceof Array ? self.ignoreCSS : [self.ignoreCSS];\n    settings.emptyCSS = self.emptyCSS instanceof Array ? self.emptyCSS : [self.emptyCSS];\n    settings.formatValue = self.formatValue.bind(this, settings.trimWhitespace);\n    settings.bootstrapSettings = _getBootstrapSettings(settings.bootstrap, self.bootstrapConfig, self.defaultButton);\n\n    var _exportData = {};\n    self.getExportData = function() {\n      return _exportData;\n    };\n\n    self.selectors.forEach(function(el) {\n      var context = {};\n\n      context.rows = _nodesArray(el.querySelectorAll(\"tbody > tr\"));\n      context.rows = settings.headers ? _nodesArray(el.querySelectorAll(\"thead > tr\")).concat(context.rows) : context.rows;\n      context.rows = settings.footers ? context.rows.concat(_nodesArray(el.querySelectorAll(\"tfoot > tr\"))) : context.rows;\n      context.thAdj = settings.headers ? el.querySelectorAll(\"thead > tr\").length : 0;\n      context.filename = settings.filename === \"id\" ? el.getAttribute(\"id\") || self.defaultFilename : settings.filename || self.defaultFilename;\n      context.sheetname = settings.sheetname === \"id\" ? el.getAttribute(\"id\") || self.defaultSheetname : settings.sheetname || self.defaultSheetname;\n      context.uuid = _uuid(el);\n\n      /**\n       * Initializes table caption with export buttons\n       * @param exportButton {HTMLButtonElement}\n       */\n      context.checkCaption = function(exportButton) {\n        var caption = el.querySelectorAll(\"caption.\" + self.defaultCaptionClass);\n        if (caption.length) {\n          caption[0].appendChild(exportButton);\n        } else {\n          caption = document.createElement(\"caption\");\n          caption.className = settings.bootstrapSettings.bootstrapSpacing + self.defaultCaptionClass;\n          caption.style.cssText = \"caption-side: \" + settings.position;\n          caption.appendChild(exportButton);\n          el.insertBefore(caption, el.firstChild);\n        }\n      };\n\n      context.setExportData = (function() {\n        return function(exporter) {\n          var data = Storage.getInstance().getItem(exporter);\n          var type = exporter.substring(exporter.indexOf(\"-\") + 1);\n          _exportData[context.uuid] = _exportData[context.uuid] || {};\n          _exportData[context.uuid][type] = JSON.parse(data);\n        };\n      })();\n\n      context.rcMap = new RowColMap().build(context, settings);\n\n      var formatMap = _FORMAT_LIST.reduce(function(acc, cur) {\n        acc[cur] = 0;\n        return acc;\n      }, {});\n\n      settings.formats.forEach(function(key) {\n        if (!_isValidFormat(key)) {\n          return _handleError('\"' + key + '\" is not a valid format. \\nFormats: ' + _FORMAT_LIST.join(\", \"));\n        } else if (!_hasDependencies(key)) {\n          // TODO: provide a fallback option to XLS?\n          return _handleError('\"' + key + '\" requires \"js-xlsx\".');\n        } else if (!formatMap[key]) {\n          context.setExportData(self.exporters.build.call(self, context, key));\n          formatMap[key]++;\n        }\n      });\n    });\n\n    var exportButton = document.querySelectorAll(\"button[\" + self.storageKey + \"]\");\n    _on(exportButton, \"click\", self.downloadHandler, self);\n\n    return self;\n  };\n\n  TableExport.prototype = {\n    /**\n     * Version.\n     * @memberof TableExport.prototype\n     */\n    version: \"5.2.0\",\n    /**\n     * Default library options.\n     * @memberof TableExport.prototype\n     */\n    defaults: {\n      headers: true, // (Boolean), display table headers (th or td elements) in the <thead>, (default: true)\n      footers: true, // (Boolean), display table footers (th or td elements) in the <tfoot>, (default: false)\n      formats: [\"xlsx\", \"csv\", \"txt\"], // (String[]), filetype(s) for the export, (default: ['xlsx', 'csv', 'txt'])\n      filename: \"id\", // (id, String), filename for the downloaded file, (default: 'id')\n      bootstrap: false, // (Boolean), style buttons using bootstrap, (default: true)\n      exportButtons: true, // (Boolean), automatically generate the built-in export buttons for each of the specified formats (default: true)\n      position: \"bottom\", // (top, bottom), position of the caption element relative to table, (default: 'bottom')\n      ignoreRows: null, // (Number, Number[]), row indices to exclude from the exported file(s) (default: null)\n      ignoreCols: null, // (Number, Number[]), column indices to exclude from the exported file(s) (default: null)\n      trimWhitespace: true, // (Boolean), remove all leading/trailing newlines, spaces, and tabs from cell text in the exported file(s) (default: false)\n      RTL: false, // (Boolean), set direction of the worksheet to right-to-left (default: false)\n      sheetname: \"id\" // (id, String), sheet name for the exported spreadsheet, (default: 'id')\n    },\n    /**\n     * Constants\n     * @memberof TableExport.prototype\n     */\n    CONSTANTS: {\n      FORMAT: {\n        XLSX: \"xlsx\",\n        XLSM: \"xlsm\",\n        XLSB: \"xlsb\",\n        BIFF2: \"biff2\",\n        XLS: \"xls\",\n        CSV: \"csv\",\n        TXT: \"txt\"\n      },\n      TYPE: {\n        STRING: \"s\",\n        NUMBER: \"n\",\n        BOOLEAN: \"b\",\n        DATE: \"d\"\n      }\n    },\n    /**\n     * Character set (character encoding) of the HTML.\n     * @memberof TableExport.prototype\n     */\n    charset: \"charset=utf-8\",\n    /**\n     * Filename fallback for exported files.\n     * @memberof TableExport.prototype\n     */\n    defaultFilename: \"myDownload\",\n    /**\n     * Sheetname fallback for exported files.\n     * @memberof TableExport.prototype\n     */\n    defaultSheetname: \"myWorksheet\",\n    /**\n     * Class applied to each export button element.\n     * @memberof TableExport.prototype\n     */\n    defaultButton: \"button-default\",\n    /**\n     * Class applied to each table caption.\n     * @memberof TableExport.prototype\n     */\n    defaultCaptionClass: \"tableexport-caption\",\n    /**\n     * Namespace (i.e. prefix) applied to each table UUID and Storage key.\n     * @memberof TableExport.prototype\n     */\n    defaultNamespace: \"tableexport-\",\n    /**\n     * Attribute applied to each table element used to generate each Storage key.\n     * @memberof TableExport.prototype\n     */\n    tableKey: \"tableexport-key\",\n    /**\n     * Attribute applied to each export button element used to reference a Storage key.\n     * @memberof TableExport.prototype\n     */\n    storageKey: \"tableexport-id\",\n    /**\n     * CSS selector or selector[] to exclude/remove cells from the exported file(s).\n     * @type {selector|selector[]}\n     * @memberof TableExport.prototype\n     */\n    ignoreCSS: \".tableexport-ignore\",\n    /**\n     * CSS selector or selector[] to replace cells with an empty string in the exported file(s).\n     * @type {selector|selector[]}\n     * @memberof TableExport.prototype\n     */\n    emptyCSS: \".tableexport-empty\",\n    /**\n     * Bootstrap configuration classes ['base', 'theme', 'container'].\n     * @memberof TableExport.prototype\n     */\n    bootstrapConfig: [\"btn\", \"btn-default\", \"btn-toolbar\"],\n    /**\n     * Row delimeter\n     * @memberof TableExport.prototype\n     */\n    rowDel: \"\\r\\n\",\n    /**\n     * HTML entity mapping for special characters.\n     * @memberof TableExport.prototype\n     */\n    entityMap: {\n      \"&\": \"&#38;\",\n      \"<\": \"&#60;\",\n      \">\": \"&#62;\",\n      \"'\": \"&#39;\",\n      \"/\": \"&#47;\"\n    },\n    /**\n     * Format configuration\n     * @memberof TableExport.prototype\n     */\n    formatConfig: {\n      /**\n       * XLSX (Open XML spreadsheet) file extension configuration\n       * @memberof TableExport.prototype\n       */\n      xlsx: {\n        defaultClass: \"xlsx\",\n        buttonContent: \"Export to xlsx\",\n        mimeType: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n        fileExtension: \".xlsx\"\n      },\n      xlsm: {\n        defaultClass: \"xlsm\",\n        buttonContent: \"Export to xlsm\",\n        mimeType: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n        fileExtension: \".xlsm\"\n      },\n      xlsb: {\n        defaultClass: \"xlsb\",\n        buttonContent: \"Export to xlsb\",\n        mimeType: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\n        fileExtension: \".xlsb\"\n      },\n      /**\n       * XLS (Binary spreadsheet) file extension configuration\n       * @memberof TableExport.prototype\n       */\n      xls: {\n        defaultClass: \"xls\",\n        buttonContent: \"Export to xls\",\n        separator: \"\\t\",\n        mimeType: \"application/vnd.ms-excel\",\n        fileExtension: \".xls\",\n        enforceStrictRFC4180: false\n      },\n      /**\n       * CSV (Comma Separated Values) file extension configuration\n       * @memberof TableExport.prototype\n       */\n      csv: {\n        defaultClass: \"csv\",\n        buttonContent: \"Export to csv\",\n        separator: \",\",\n        mimeType: \"text/csv\",\n        fileExtension: \".csv\",\n        enforceStrictRFC4180: true\n      },\n      /**\n       * TXT (Plain Text) file extension configuration\n       * @memberof TableExport.prototype\n       */\n      txt: {\n        defaultClass: \"txt\",\n        buttonContent: \"Export to txt\",\n        separator: \"  \",\n        mimeType: \"text/plain\",\n        fileExtension: \".txt\",\n        enforceStrictRFC4180: true\n      }\n    },\n    /**\n     * Cell-types override and assertion configuration\n     * @memberof TableExport.prototype\n     */\n    typeConfig: {\n      string: {\n        defaultClass: \"tableexport-string\"\n      },\n      number: {\n        defaultClass: \"tableexport-number\",\n        assert: function(v) {\n          return !isNaN(v);\n        }\n      },\n      boolean: {\n        defaultClass: \"tableexport-boolean\",\n        assert: function(v) {\n          return v.toLowerCase() === \"true\" || v.toLowerCase() === \"false\";\n        }\n      },\n      date: {\n        defaultClass: \"tableexport-date\",\n        assert: function(v) {\n          return !/.*%/.test(v) && !isNaN(Date.parse(v));\n        }\n      }\n    },\n    exporters: {\n      build: function(context, key) {\n        var self = this;\n        var settings = self.settings;\n        var format = self.formatConfig[key];\n        var colDel = format.separator;\n        var rcMap = context.rcMap;\n\n        var getReturn = function(val) {\n          if (_isEnhanced(key)) {\n            return {\n              v: settings.formatValue(val.textContent),\n              t: self.getType(val.className)\n            };\n          }\n          switch (key) {\n            case _FORMAT.CSV:\n              return '\"' + settings.formatValue(val.textContent.replace(/\"/g, '\"\"')) + '\"';\n            default:\n              return settings.formatValue(val.textContent);\n          }\n        };\n\n        var dataURI = _nodesArray(context.rows)\n          .map(function(val, ir) {\n            if (rcMap.isIgnore(ir)) {\n              return rcMap.handleRowColMapProp(rcMap.TYPE.IGNORE);\n            } else if (rcMap.isEmpty(ir)) {\n              return rcMap.handleRowColMapProp(rcMap.TYPE.EMPTY);\n            }\n            var cols = val.querySelectorAll(\"th, td\");\n            return _nodesArray(cols)\n              .map(function(val, ic) {\n                var _return = getReturn(val);\n                if (rcMap.isIgnore(ir, ic)) {\n                  return rcMap.handleRowColMapProp(rcMap.TYPE.IGNORE);\n                } else if (rcMap.isEmpty(ir, ic)) {\n                  return rcMap.handleRowColMapProp(rcMap.TYPE.EMPTY);\n                } else {\n                  return rcMap.handleRowColMapProp(rcMap.TYPE.DEFAULT, ir, ic, key, _return, colDel);\n                }\n              })\n              .processCols(key, colDel);\n          })\n          .processRows(key, self.rowDel);\n\n        var dataObject = JSON.stringify({\n          data: dataURI,\n          filename: context.filename,\n          mimeType: format.mimeType,\n          fileExtension: format.fileExtension,\n          merges: rcMap.merges,\n          RTL: settings.RTL,\n          sheetname: settings.sheetname\n        });\n\n        var hashKey = _hashCode({ uuid: context.uuid, type: key });\n\n        settings.exportButtons &&\n          context.checkCaption(self.createObjButton(hashKey, dataObject, format.buttonContent, format.defaultClass, settings.bootstrapSettings));\n        return Storage.getInstance().setItem(hashKey, dataObject, true);\n      }\n    },\n    /**\n     * Creates file export buttons\n     * @param hashKey {String}\n     * @param dataObject {String}\n     * @param myContent {String}\n     * @param myClass {String}\n     * @param bootstrapSettings {Object}\n     * @returns Element\n     */\n    createObjButton: function(hashKey, dataObject, myContent, myClass, bootstrapSettings) {\n      var exportButton = document.createElement(\"button\");\n      exportButton.setAttribute(\"type\", \"button\");\n      exportButton.setAttribute(this.storageKey, hashKey);\n      exportButton.className = bootstrapSettings.bootstrapClass + bootstrapSettings.bootstrapTheme + myClass;\n      exportButton.textContent = myContent;\n      return exportButton;\n    },\n    /**\n     * Escapes special characters with HTML entities\n     * @memberof TableExport.prototype\n     * @param string {String}\n     * @returns {String} escaped string\n     */\n    escapeHtml: function(string) {\n      var self = this;\n      return String(string).replace(/[&<>'\\/]/g, function(s) {\n        return self.entityMap[s];\n      });\n    },\n    /**\n     * Unescapes HTML entities to special characters\n     * @memberof TableExport.prototype\n     * @param string {String}\n     * @returns {String} unescaped string\n     */\n    unescapeHtml: function(string) {\n      var str = String(string);\n      for (var key in this.entityMap) {\n        str = str.replace(RegExp(this.entityMap[key], \"g\"), key);\n      }\n      return str;\n    },\n    /**\n     * Removes leading/trailing whitespace from cell string\n     * @param isTrimWhitespace {Boolean}\n     * @param string {String}\n     * @returns {String} trimmed string\n     */\n    formatValue: function(isTrimWhitespace, string) {\n      return isTrimWhitespace ? string.trim() : string;\n    },\n    /**\n     * Get cell data-type\n     * @param string {String}\n     * @returns {String} data-type\n     */\n    getType: function(string) {\n      if (!string) return \"\";\n      var types = this.typeConfig;\n      if (~string.indexOf(types.string.defaultClass)) {\n        return _TYPE.STRING;\n      } else if (~string.indexOf(types.number.defaultClass)) {\n        return _TYPE.NUMBER;\n      } else if (~string.indexOf(types.boolean.defaultClass)) {\n        return _TYPE.BOOLEAN;\n      } else if (~string.indexOf(types.date.defaultClass)) {\n        return _TYPE.DATE;\n      } else {\n        return \"\";\n      }\n    },\n    /**\n     * Formats datetimes for compatibility with Excel\n     * @memberof TableExport.prototype\n     * @param v {Number}\n     * @param date1904 {Date}\n     * @returns {Number} epoch time\n     */\n    dateNum: function(v, date1904) {\n      if (date1904) v += 1462;\n      var epoch = Date.parse(v);\n      var result = (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n      return Math.floor(result);\n    },\n    /**\n     * Creates an Excel spreadsheet from a data string\n     * @memberof TableExport.prototype\n     * @param data {String}\n     * @param merges {Object[]}\n     */\n    createSheet: function(data, merges) {\n      var ws = {};\n      var range = { s: { c: 10000000, r: 10000000 }, e: { c: 0, r: 0 } };\n      var types = this.typeConfig;\n      for (var R = 0; R !== data.length; ++R) {\n        for (var C = 0; C !== data[R].length; ++C) {\n          if (range.s.r > R) range.s.r = R;\n          if (range.s.c > C) range.s.c = C;\n          if (range.e.r < R) range.e.r = R;\n          if (range.e.c < C) range.e.c = C;\n          var cell = data[R][C];\n          if (!cell || !cell.v) continue;\n          var cell_ref = XLSX.utils.encode_cell({ c: C, r: R });\n\n          if (!cell.t) {\n            if (types.number.assert(cell.v)) cell.t = _TYPE.NUMBER;\n            else if (types.boolean.assert(cell.v)) cell.t = _TYPE.BOOLEAN;\n            else if (types.date.assert(cell.v)) cell.t = _TYPE.DATE;\n            else cell.t = _TYPE.STRING;\n          }\n          if (cell.t === _TYPE.DATE) {\n            cell.t = _TYPE.NUMBER;\n            cell.z = XLSX.SSF._table[14];\n            cell.v = this.dateNum(cell.v);\n          }\n          ws[cell_ref] = cell;\n        }\n      }\n      ws[\"!merges\"] = merges;\n      if (range.s.c < 10000000) ws[\"!ref\"] = XLSX.utils.encode_range(range);\n      return ws;\n    },\n    /**\n     * Click handler for export button \"download\"\n     * @memberof TableExport.prototype\n     */\n    downloadHandler: function(event) {\n      var target = event.target;\n      var object = JSON.parse(Storage.getInstance().getItem(target.getAttribute(this.storageKey))),\n        data = object.data,\n        filename = object.filename,\n        mimeType = object.mimeType,\n        fileExtension = object.fileExtension,\n        merges = object.merges,\n        RTL = object.RTL,\n        sheetname = object.sheetname;\n      this.export2file(data, mimeType, filename, fileExtension, merges, RTL, sheetname);\n    },\n    /**\n     * Excel Workbook constructor\n     * @memberof TableExport.prototype\n     * @constructor\n     */\n    Workbook: function() {\n      this.Workbook = { Views: [] };\n      this.SheetNames = [];\n      this.Sheets = {};\n    },\n    /**\n     * Converts a string to an arraybuffer\n     * @param s {String}\n     * @memberof TableExport.prototype\n     * @returns {ArrayBuffer}\n     */\n    string2ArrayBuffer: function(s) {\n      var buf = new ArrayBuffer(s.length);\n      var view = new Uint8Array(buf);\n      for (var i = 0; i !== s.length; ++i) view[i] = s.charCodeAt(i) & 0xff;\n      return buf;\n    },\n    /**\n     * Exports and downloads the file\n     * @memberof TableExport.prototype\n     * @param data {String}\n     * @param mime {String} mime type\n     * @param name {String} filename\n     * @param extension {String} file extension\n     * @param merges {Object[]}\n     * @param RTL {Boolean}\n     */\n    export2file: function(data, mime, name, extension, merges, RTL, sheetname) {\n      var format = extension.slice(1);\n      data = this.getRawData(data, extension, name, merges, RTL, sheetname);\n\n      if (_isMobile && (format === _FORMAT.CSV || format === _FORMAT.TXT)) {\n        var dataURI = \"data:\" + mime + \";\" + this.charset + \",\" + data;\n        this.downloadDataURI(dataURI, name, extension);\n      } else {\n        // TODO: error and fallback when `saveAs` not available\n        saveAs(new Blob([data], { type: mime + \";\" + this.charset }), name + extension, true);\n      }\n    },\n    downloadDataURI: function(dataURI, name, extension) {\n      var encodedUri = encodeURI(dataURI);\n      var link = document.createElement(\"a\");\n      link.setAttribute(\"href\", encodedUri);\n      link.setAttribute(\"download\", name + extension);\n      document.body.appendChild(link);\n      link.click();\n    },\n    getBookType: function(key) {\n      switch (key) {\n        case _FORMAT.XLS:\n          return _FORMAT.BIFF2;\n        default:\n          return key;\n      }\n    },\n    getRawData: function(data, extension, name, merges, RTL, sheetname) {\n      var key = extension.substring(1);\n\n      if (_isEnhanced(key)) {\n        var wb = new this.Workbook(),\n          ws = this.createSheet(data, merges),\n          bookType = this.getBookType(key);\n\n        sheetname = sheetname || \"\";\n        wb.SheetNames.push(sheetname);\n        wb.Sheets[sheetname] = ws;\n        wb.Workbook.Views[0] = { RTL: RTL };\n        var wopts = {\n            bookType: bookType,\n            bookSST: false,\n            type: \"binary\"\n          },\n          wbout = XLSX.write(wb, wopts);\n\n        data = this.string2ArrayBuffer(wbout);\n      }\n      return data;\n    },\n    getFileSize: function(data, extension) {\n      var binary = this.getRawData(data, extension);\n      return binary instanceof ArrayBuffer ? binary.byteLength : this.string2ArrayBuffer(binary).byteLength;\n    },\n    /**\n     * Updates the library instance with new/updated options\n     * @param options {Object} TableExport configuration options\n     * @returns {TableExport} updated TableExport instance\n     */\n    update: function(options) {\n      this.remove();\n      return new TableExport(this.selectors, _extend({}, this.defaults, options));\n    },\n    /**\n     * Reset the library instance to its original state\n     * @returns {TableExport} original TableExport instance\n     */\n    reset: function() {\n      this.remove();\n      return new TableExport(this.selectors, this.settings);\n    },\n    /**\n     * Remove the instance (i.e. caption containing the export buttons)\n     */\n    remove: function() {\n      var self = this;\n      this.selectors.forEach(function(el) {\n        var caption = el.querySelector(\"caption.\" + self.defaultCaptionClass);\n        caption && el.removeChild(caption);\n      });\n    }\n  };\n\n  /**\n   * Storage main interface constructor\n   * @memberof TableExport.prototype\n   * @constructor\n   */\n  var Storage = function() {\n    this._instance = null;\n\n    this.store = sessionStorage;\n    this.namespace = TableExport.prototype.defaultNamespace;\n    this.getKey = function(key) {\n      return this.namespace + key;\n    };\n    this.setItem = function(_key, value, overwrite) {\n      var key = this.getKey(_key);\n      if (this.exists(_key) && !overwrite) {\n        return;\n      }\n      if (typeof value !== \"string\") return _handleError('\"value\" must be a string.');\n      this.store.setItem(key, value);\n      return _key;\n    };\n    this.getItem = function(_key) {\n      var key = this.getKey(_key);\n      return this.store.getItem(key);\n    };\n    this.exists = function(_key) {\n      var key = this.getKey(_key);\n      return this.store.getItem(key) !== null;\n    };\n    this.removeItem = function(_key) {\n      var key = this.getKey(_key);\n      return this.store.removeItem(key);\n    };\n  };\n  Storage.getInstance = function() {\n    if (!this._instance) {\n      this._instance = new Storage();\n    }\n    return this._instance;\n  };\n\n  /**\n   * RowColMap main interface constructor\n   * @memberof TableExport.prototype\n   * @constructor\n   */\n  var RowColMap = function() {\n    this.rcMap = [];\n    this.merges = [];\n\n    this.isIgnore = function(ir, ic) {\n      var _ignore = RowColMap.prototype.TYPE.IGNORE;\n      return this.getRowColMapProp(ir, ic, _ignore);\n    };\n    this.isEmpty = function(ir, ic) {\n      var _empty = RowColMap.prototype.TYPE.EMPTY;\n      return this.getRowColMapProp(ir, ic, _empty);\n    };\n    this.isRowSpan = function(ir) {\n      var _rowspan = RowColMap.prototype.TYPE.ROWSPAN;\n      return this.getRowColMapProp(ir, undefined, _rowspan);\n    };\n    this.isColSpan = function(ir) {\n      var _colspan = RowColMap.prototype.TYPE.COLSPAN;\n      return this.getRowColMapProp(ir, undefined, _colspan);\n    };\n    this.isSpan = function(ir) {\n      return this.isRowSpan(ir) || this.isColSpan(ir);\n    };\n    this.isMerge = function(ir) {\n      return this.merges.length > 0;\n    };\n    this.addMerge = function(ir, mergeObj) {\n      var _merge = RowColMap.prototype.TYPE.MERGE;\n      this.merges.push(mergeObj);\n      this.setRowColMapProp(ir, undefined, _merge, this.merges);\n    };\n    this.getRowColMapProp = function(ir, ic, key) {\n      if (this.rcMap[ir]) {\n        if (typeof key === \"undefined\") {\n          return this.rcMap[ir][ic];\n        } else if (typeof ic === \"undefined\") {\n          return this.rcMap[ir][key];\n        } else if (this.rcMap[ir][ic]) {\n          return this.rcMap[ir][ic][key];\n        }\n      }\n      return undefined;\n    };\n    this.setRowColMapProp = function(ir, ic, key, value) {\n      this.rcMap[ir] = this.rcMap[ir] || [];\n      if (typeof key === \"undefined\") {\n        return (this.rcMap[ir][ic] = value);\n      } else if (typeof ic === \"undefined\") {\n        return (this.rcMap[ir][key] = value);\n      } else {\n        this.rcMap[ir][ic] = this.rcMap[ir][ic] || [];\n        return (this.rcMap[ir][ic][key] = value);\n      }\n    };\n    this.generateTotal = function(ir, ic) {\n      var VALUE = RowColMap.prototype.TYPE.VALUE;\n      var _total = 0;\n\n      if (this.isRowSpan(ir) && this.isColSpan(ir)) {\n        _total = this.getRowColMapProp(ir, ic, VALUE) || 0;\n      } else if (this.getRowColMapProp(ir, ic, VALUE)) {\n        _total = this.getRowColMapProp(ir, ic, VALUE);\n      }\n      return _total;\n    };\n    this.convertSpanToArray = function(ir, ic, key, _return, colDel) {\n      if (this.rcMap[ir] && this.isSpan(ir)) {\n        var total = this.generateTotal(ir, ic);\n\n        if (_isEnhanced(key)) {\n          return new Array(total).concat(_return);\n        } else {\n          return new Array(total).concat(_return).join(colDel);\n        }\n      }\n      return _return;\n    };\n    this.handleRowColMapProp = function(type, ir, ic, key, _return, colDel) {\n      switch (type) {\n        case RowColMap.prototype.TYPE.IGNORE:\n          return;\n        case RowColMap.prototype.TYPE.EMPTY:\n          return \" \";\n        case RowColMap.prototype.TYPE.DEFAULT:\n        default:\n          return this.convertSpanToArray(ir, ic, key, _return, colDel);\n      }\n    };\n  };\n  RowColMap.prototype = {\n    OFFSET: 1,\n    TYPE: {\n      IGNORE: \"ignore\",\n      EMPTY: \"empty\",\n      MERGE: \"merge\",\n      ROWSPAN: \"rowspan\",\n      ROWSPANTOTAL: \"rowspantotal\",\n      COLSPAN: \"colspan\",\n      COLSPANTOTAL: \"colspantotal\",\n      DEFAULT: \"default\",\n      VALUE: \"value\"\n    },\n    build: function(context, settings) {\n      var self = this;\n\n      var OFFSET = self.OFFSET;\n      var rowLength = (self.rowLength = context.rows.length);\n      // var colLength = self.colLength = Math.max.apply(null,\n      //     _nodesArray(context.rows).map(function (val) {\n      //         return val.querySelectorAll('th, td').length\n      //     }));\n\n      var handleIgnore = function(ir, ic) {\n        self.setRowColMapProp(ir, ic, self.TYPE.IGNORE, true);\n      };\n      var handleEmpty = function(ir, ic) {\n        self.setRowColMapProp(ir, ic, self.TYPE.EMPTY, true);\n      };\n      var handleRowSpan = function(val, ir, ic) {\n        var rowSpan = +val.getAttribute(\"rowspan\");\n        var colSpan = +val.getAttribute(\"colspan\");\n        var handledByColSpan, countRowSpan, countColSpan, totalRowSpan, totalColSpan, irStart, irEnd, icStart, icEnd;\n\n        for (var _row = 0; _row < rowSpan; _row++) {\n          if (_row + ir >= rowLength) {\n            return;\n          }\n          colSpan && (handledByColSpan = handleColSpan(val, _row + ir, ic, _row > 0, rowSpan));\n\n          if (rowSpan <= 1) {\n            return false;\n          }\n          var cur = self.rcMap[\"c\" + (ic - 1)] ? self.rcMap[\"c\" + (ic - 1)][_row + ir] : 0;\n          if (cur) {\n            self.rcMap[\"c\" + ic] = self.rcMap[\"c\" + ic] || [];\n            self.rcMap[\"c\" + ic][_row + ir] = (self.rcMap[\"c\" + ic][_row + ir] || 0) + cur;\n          }\n\n          if (rowSpan && _row === 0 && colSpan > 1) {\n            for (var i = 0; i < rowSpan; i++) {\n              self.rcMap[\"c\" + (ic + 1)] = self.rcMap[\"c\" + (ic + 1)] || [];\n              self.rcMap[\"c\" + (ic + 1)][_row + ir + i] = (self.rcMap[\"c\" + (ic + 1)][_row + ir + i] || 0) + Math.max(1, colSpan);\n            }\n          }\n\n          if (_row >= 1) {\n            countRowSpan = self.getRowColMapProp(_row + ir, undefined, self.TYPE.ROWSPAN) || 0;\n            self.setRowColMapProp(_row + ir, undefined, self.TYPE.ROWSPAN, countRowSpan + 1);\n\n            if (!handledByColSpan) {\n              totalRowSpan = self.getRowColMapProp(_row + ir, ic - countRowSpan, self.TYPE.VALUE) || 0;\n              self.setRowColMapProp(_row + ir, ic - countRowSpan, self.TYPE.VALUE, totalRowSpan + 1);\n              if (rowSpan > 1 && _row === 1) {\n                var _re = self.rcMap[\"c\" + ic] && self.rcMap[\"c\" + ic][_row + ir];\n                totalColSpan = self.getRowColMapProp(ir, undefined, self.TYPE.COLSPANTOTAL) || 0;\n                countColSpan = self.getRowColMapProp(ir, undefined, self.TYPE.COLSPAN) || 0;\n                irStart = ir;\n                irEnd = ir + rowSpan - 1;\n                icStart = ic + totalColSpan - countColSpan + (_re || 0);\n                icEnd = icStart + Math.max(1, colSpan) - 1;\n                handleMerge(irStart, icStart, irEnd, icEnd);\n              }\n            }\n          }\n        }\n      };\n\n      var handleColSpan = function(val, ir, ic, isRowSpan, rowSpan) {\n        var irStart, irEnd, icStart, icEnd;\n        var colSpan = +val.getAttribute(\"colspan\");\n        var countColSpan = self.getRowColMapProp(ir, undefined, self.TYPE.COLSPAN) || 0;\n        var totalColSpan = self.getRowColMapProp(ir, undefined, self.TYPE.COLSPANTOTAL) || 0;\n\n        if (colSpan <= 1) {\n          return false;\n        }\n\n        self.setRowColMapProp(ir, undefined, self.TYPE.COLSPAN, countColSpan + 1);\n        self.setRowColMapProp(ir, undefined, self.TYPE.COLSPANTOTAL, totalColSpan + colSpan);\n\n        if (isRowSpan) {\n          self.setRowColMapProp(ir, ic - countColSpan, self.TYPE.VALUE, colSpan);\n          return true;\n        } else {\n          irStart = ir;\n          irEnd = ir + (rowSpan || 1) - OFFSET;\n          icStart = ic + totalColSpan - countColSpan;\n          icEnd = ic + totalColSpan - countColSpan + (colSpan - OFFSET);\n          self.setRowColMapProp(ir, ic + OFFSET, self.TYPE.VALUE, colSpan - OFFSET);\n          handleMerge(irStart, icStart, irEnd, icEnd);\n        }\n      };\n\n      var handleMerge = function(irs, ics, ire, ice) {\n        var merge = {\n          s: { r: irs, c: ics },\n          e: { r: ire, c: ice }\n        };\n        return self.addMerge(irs, merge);\n      };\n\n      _nodesArray(context.rows).map(function(val, ir) {\n        if (!!~settings.ignoreRows.indexOf(ir - context.thAdj) || _matches(val, settings.ignoreCSS)) {\n          handleIgnore(ir);\n        }\n        if (_matches(val, settings.emptyCSS)) {\n          handleEmpty(ir);\n        }\n        var cols = val.querySelectorAll(\"th, td\");\n        return _nodesArray(cols).map(function(val, ic) {\n          if (!!~settings.ignoreCols.indexOf(ic) || _matches(val, settings.ignoreCSS)) {\n            handleIgnore(ir, ic);\n          }\n          if (_matches(val, settings.emptyCSS)) {\n            handleEmpty(ir, ic);\n          }\n          if (val.hasAttribute(\"rowspan\")) {\n            handleRowSpan(val, ir, ic);\n          } else if (val.hasAttribute(\"colspan\")) {\n            handleColSpan(val, ir, ic);\n          }\n        });\n      });\n\n      return self;\n    }\n  };\n\n  var _isMobile = (function isMobile(ua) {\n    return (\n      /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(\n        ua\n      ) ||\n      /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(\n        ua.substring(0, 4)\n      )\n    );\n  })(navigator.userAgent || navigator.vendor || window.opera);\n\n  var _isEnhanced = (function() {\n    return function(key) {\n      return XLSX && !TableExport.prototype.formatConfig[key].enforceStrictRFC4180;\n    };\n  })();\n\n  var _FORMAT = (function() {\n    return TableExport.prototype.CONSTANTS.FORMAT;\n  })();\n\n  var _FORMAT_LIST = (function() {\n    return Object.keys(_FORMAT).map(function(key) {\n      return _FORMAT[key];\n    });\n  })();\n\n  var _TYPE = (function() {\n    return TableExport.prototype.CONSTANTS.TYPE;\n  })();\n\n  Object.defineProperty(Array.prototype, \"processRows\", {\n    enumerable: false,\n    value: function(key, rowDel) {\n      if (_isEnhanced(key)) {\n        return this.map(_toArray).filter(_defined);\n      } else {\n        return this.filter(_defined).join(rowDel);\n      }\n    }\n  });\n\n  Object.defineProperty(Array.prototype, \"processCols\", {\n    enumerable: false,\n    value: function(key, colDel) {\n      if (_isEnhanced(key)) {\n        return this.filter(_defined);\n      } else {\n        return this.filter(_defined).join(colDel);\n      }\n    }\n  });\n\n  var _uuid = (function() {\n    var uuid = 0;\n\n    return function(el) {\n      var tableKey = el.getAttribute(TableExport.prototype.tableKey);\n\n      if (!tableKey) {\n        tableKey = el.id ? el.id : TableExport.prototype.defaultNamespace + ++uuid;\n        el.setAttribute(TableExport.prototype.tableKey, tableKey);\n      }\n      return tableKey;\n    };\n  })();\n\n  var _hashCode = (function() {\n    return function(hashKey) {\n      var hash = 0,\n        i,\n        char;\n\n      var type = hashKey.type;\n      hashKey = JSON.stringify(hashKey);\n      if (hashKey.length === 0) return hash;\n      for (i = 0; i < hashKey.length; i++) {\n        char = hashKey.charCodeAt(i);\n        hash = (hash << 5) - hash + char;\n        hash |= 0;\n      }\n      return hash.toString(16).substring(1) + \"-\" + type;\n    };\n  })();\n\n  var _on = (function() {\n    var prevFn = null;\n\n    return function(el, event, fn, context) {\n      // , args\n      var curFn = fn.bind(context);\n      // var curFn = fn.bind.apply(fn, [context].concat(args)); // OR [].slice.call(arguments[4]))\n      for (var i = 0; i < el.length; ++i) {\n        prevFn && el[i].removeEventListener(event, prevFn, false);\n        el[i].addEventListener(event, curFn, false);\n      }\n      prevFn = curFn;\n    };\n  })();\n\n  function _extend() {\n    var args = arguments;\n    for (var i = 1; i < args.length; i++) for (var key in args[i]) if (args[i].hasOwnProperty(key)) args[0][key] = args[i][key];\n    return args[0];\n  }\n\n  function _nodesArray(els) {\n    return typeof els.length === \"undefined\" ? [].concat(els) : [].slice.call(els);\n  }\n\n  function _hasClass(el, cls) {\n    return el.classList ? el.classList.contains(cls) : new RegExp(\"(^| )\" + cls + \"( |$)\", \"gi\").test(el.cls);\n  }\n\n  function _matches(el, selectors) {\n    return (\n      selectors.filter(function(selector) {\n        return [].indexOf.call(document.querySelectorAll(selector), el) !== -1;\n      }).length > 0\n    );\n  }\n\n  function _numeric(val) {\n    return !isNaN(val);\n  }\n\n  function _defined(val) {\n    return typeof val !== \"undefined\";\n  }\n\n  function _toArray(val) {\n    return val instanceof Array ? [].concat.apply([], val) : val;\n  }\n\n  function _isValidFormat(key) {\n    return ~_FORMAT_LIST.indexOf(key);\n  }\n\n  function _hasDependencies(key) {\n    var hasDependencies;\n\n    switch (key) {\n      case _FORMAT.TXT:\n      case _FORMAT.CSV:\n      case _FORMAT.XLS:\n        hasDependencies = true;\n        break;\n      default:\n        hasDependencies = _isEnhanced(key);\n    }\n    return hasDependencies;\n  }\n\n  function _handleError(msg) {\n    console.error(msg);\n    return new Error(msg);\n  }\n\n  function _getBootstrapSettings(bootstrap, bootstrapConfig, defaultButton) {\n    var config = {};\n    if (bootstrap) {\n      config.bootstrapClass = bootstrapConfig[0] + \" \";\n      config.bootstrapTheme = bootstrapConfig[1] + \" \";\n      config.bootstrapSpacing = bootstrapConfig[2] + \" \";\n    } else {\n      config.bootstrapClass = defaultButton + \" \";\n      config.bootstrapTheme = \"\";\n      config.bootstrapSpacing = \"\";\n    }\n    return config;\n  }\n\n  if ($) {\n    /**\n     * jQuery TableExport wrapper\n     * @param options {Object} TableExport configuration options\n     * @returns {TableExport} TableExport instance\n     */\n    $.fn.tableExport = function(options) {\n      return TableExport.call(_extend({}, TableExport.prototype, $.fn.tableExport), this, options);\n    };\n\n    // alias the TableExport prototype\n    for (var prop in TableExport.prototype) {\n      $.fn.tableExport[prop] = TableExport.prototype[prop];\n    }\n  }\n\n  TableExport.TableExport = TableExport;\n\n  return TableExport;\n});\n"]},"metadata":{},"sourceType":"script"}